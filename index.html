<!DOCTYPE html>
<html>
<head>
  <title>Frankenstein AI</title>
  <style type="text/css">
  html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    /*background: black;*/
    touch-action: none; 
  }
  
  img {
    display: block;
    min-height: 100%;
    min-height: 100%;
    object-fit: contain;
  }
  
  #network-config {
    position: fixed;
    background: white;
    padding: 2em;
  }
</style>
<script src="js/pixi.min.js" type="text/javascript"></script>
<script src="js/timeline.js" type="text/javascript"></script>
<script src="js/network.js" type="text/javascript"></script>
<script src="js/mapping.js" type="text/javascript"></script>
<script src="js/state.js" type="text/javascript"></script>
<script src="js/touch.js" type="text/javascript"></script>
<script src="js/words.js" type="text/javascript"></script>
<script src="js/images.js" type="text/javascript"></script>
<script type="text/javascript">
  PIXI.utils.sayHello("Frankenstein AI")
  var app, tray, sideInterface;
  
  window.onload = function() {
    // osc menu
    document.querySelector("#network-config button").onclick = function() {
      var ip = document.querySelector("input#ip").value;
      var port = parseInt(document.querySelector("input#port").value);
      connectOSC(ip, port);
      document.querySelector("#network-config").remove();
    }
    
    app = new PIXI.Application({ antialias: true, transparent: false });
    app.renderer.backgroundColor = 0xbabababa;
    app.renderer.autoResize = true;
    app.renderer.resize(window.innerWidth, window.innerHeight);
    document.body.appendChild(app.view);
    routeMouseToTouches(app.view);
    
    tray = new PIXI.Container();
    tray.position.x = window.innerWidth/2;
    tray.position.y = window.innerHeight/2;
    tray.rotation = Math.PI/2;
    app.stage.addChild(tray);
        
    tray.addChild(wordPage());
    tray.addChild(imagePage());
    
    sideInterface = new PIXI.Container();
    sideInterface.position.x = 0;
    sideInterface.position.y = 0;
    sideInterface.rotation = Math.PI/2;
    app.stage.addChild(sideInterface);
        
    app.view.addEventListener('touchmove', function(e) {
      uiState.touches = e.touches;
      e.preventDefault()
      e.stopImmediatePropagation()
    });
            
    function currentState() {
      return logic[uiState.mode];
    } 
    
    function tick(d) {
      requestAnimationFrame(tick);
      const delta = d - uiState.lastTime;
      uiState.lastTime = d;
      runTimeline(delta);
      currentState().tick(delta);
    }
    
    tick(0);
  }
</script>
</head>
<body>
  <div id="network-config">
    <h1>Network Configuration</h1>
    <input placeholder="ip address" type="text" id="ip">
    <input placeholder="port" type="text" id="port">
    <button>OK</button>
  </div>
</body>
</html>